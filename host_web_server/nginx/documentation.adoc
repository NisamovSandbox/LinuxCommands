=== Documentación NGINX
// Documentado por Andrés Ruslan Abadías Otal (Nisamov)

Instalar NGINX::

[source,bash]
----
sudo apt install nginx
----

Configurar IP fija en el equipo modificando el fichero de red.

Crear directorio para la página web::

[source,bash]
----
cd /var/www
mkdir mipagina.es
sudo chmod 755 mipagina.es
cd mipagina.es
nano index.html
----

Estructura básica del `index.html`::

[source,html]
----
<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mi Página</title>
</head>
<body>
    <p>Contenido cuerpo de página</p>
</body>
</html>
----

Registrar un subdominio en https://www.duckdns.org y asociarlo a la IP pública del equipo.

Crear fichero de configuración de NGINX::

[source,bash]
----
cd /etc/nginx/sites-available
sudo cp default mipagina.es
sudo nano mipagina.es
----

Contenido del fichero de configuración `mipagina.es`::

[source,nginx]
----
server {
    listen 80;
    root /var/www/mipagina.es;
    index index.html index.htm;
    server_name mipagina.duckdns.org www.mipagina.duckdns.org;
    location / {
        try_files $uri $uri/ =404;
    }
}
----

Hacer enlace simbólico y reiniciar NGINX::

[source,bash]
----
sudo ln -s /etc/nginx/sites-available/mipagina.es /etc/nginx/sites-enabled/mipagina.es
service nginx restart
service nginx status
----

Probar la página desde un navegador usando el dominio registrado.

Instalar OpenSSL::

[source,bash]
----
sudo apt install openssl
----

Crear directorio para claves y otorgar permisos::

[source,bash]
----
cd /etc/nginx
mkdir ssl
chmod 700 ssl
----

Generación de claves y certificado::

[source,bash]
----
openssl genrsa -out /etc/nginx/ssl/clave_privada.key 4096
openssl req -new -key /etc/nginx/ssl/clave_privada.key -out /etc/nginx/ssl/solicitud.csr
cd ssl
ls -al
openssl x509 -req -days 365 -in /etc/nginx/ssl/solicitud.csr -signkey /etc/nginx/ssl/clave_privada.key -out /etc/nginx/ssl/certificado.crt
ls -al
----

Configurar NGINX para HTTPS y HTTP::

[source,nginx]
----
server {
    listen 80;
    root /var/www/mipagina.es;
    index index.html index.htm;
    server_name mipagina.duckdns.org www.mipagina.duckdns.org;
    location / {
        try_files $uri $uri/ =404;
    }
}

server {
    listen 443 ssl;
    server_name mipagina.duckdns.org www.mipagina.duckdns.org;
    root /var/www/mipagina.es;
    index index.html index.htm;
    ssl_certificate /etc/nginx/ssl/certificado.crt;
    ssl_certificate_key /etc/nginx/ssl/clave_privada.key;
    location / {
        try_files $uri $uri/ =404;
    }
}
----

Reiniciar NGINX y comprobar el estado::

[source,bash]
----
service nginx restart
service nginx status
----
