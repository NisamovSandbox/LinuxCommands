=== Almacenamiento de usuarios y credenciales en Linux

Los usuarios del sistema, al igual que los usuarios creados manualmente, se almacenan en distintos ficheros del sistema.
Cada fichero cumple una función específica y separa la información pública de la sensible.

=== Grupos primarios y secundarios

Al crearse un usuario en el sistema:

- Se le asigna un grupo primario, que por defecto suele ser un grupo con el mismo nombre que el usuario.
- Puede pertenecer a múltiples grupos secundarios, que otorgan permisos adicionales.

La gestión de grupos permite un control granular de permisos sin necesidad de elevar privilegios.

=== Fichero /etc/passwd

El fichero `/etc/passwd` contiene información básica y no sensible sobre todos los usuarios del sistema.

Cada línea representa un usuario y sus campos están separados por dos puntos (`:`).

[cols="1,1,3,4", options="header"]
|===
| Archivo | Campo | Nombre | Descripción

| /etc/passwd | 1 | Nombre de usuario | Identificador de la cuenta
|             | 2 | Contraseña        | Marcador `x` que indica que la contraseña se almacena en `/etc/shadow`
|             | 3 | UID               | Identificador único del usuario
|             | 4 | GID               | Identificador del grupo primario
|             | 5 | GECOS             | Información descriptiva del usuario
|             | 6 | Home Directory    | Ruta absoluta del directorio personal
|             | 7 | Shell             | Programa que se ejecuta al iniciar sesión
|===

=== Fichero /etc/shadow

El fichero `/etc/shadow` almacena la información sensible relacionada con la autenticación:

- Hash de la contraseña.
- Fechas de cambio de contraseña.
- Políticas de expiración.

Este fichero solo es accesible por el usuario `root`.

=== Estados de cuenta en /etc/shadow

Algunos símbolos comunes en el campo de contraseña son:

[cols="1,3", options="header"]
|===
| Símbolo | Significado

| *
| Cuenta bloqueada, normalmente sin acceso interactivo.

| !
| Cuenta bloqueada temporalmente.

| !!
| Cuenta creada sin contraseña asignada.
|===

En usuarios de sistema es habitual encontrar estos símbolos, ya que no requieren autenticación interactiva.

=== Algoritmos de hash de contraseñas

Linux utiliza distintos algoritmos para almacenar contraseñas de forma segura.
El identificador del algoritmo aparece al inicio del hash.

[cols="1,2,4", options="header"]
|===
| Identificador | Algoritmo | Descripción

| (ninguno)
| DES
| Algoritmo obsoleto e inseguro.

| $1$
| MD5
| Inseguro por su rapidez y vulnerabilidad a fuerza bruta.

| $2a$
| Blowfish (bcrypt)
| Variante temprana de bcrypt.

| $2x$
| Blowfish (bcrypt)
| Corrige problemas de codificación de caracteres.

| $2y$
| Blowfish (bcrypt)
| Variante moderna y segura de bcrypt.

| $5$
| SHA-256
| Implementación de SHA-256 para contraseñas.

| $6$
| SHA-512
| Estándar moderno en la mayoría de distribuciones Linux.
|===

